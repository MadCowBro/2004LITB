campaignTrail_temp.election_json = [
    {
        "model": "campaign_trail.election",
        "pk": 20,
        "fields": {
            "year": 2004,
            "display_year": "Life In The Balance",
            "summary": "<div style='overflow: auto; height: 200px'>Al Gore squeaked into office after Florida's hotly contested electoral votes were given to him, following a grueling recount. What was meant to be a breezy jog into the next millennium was turned on its head with the September 11th attacks. Gore never wanted to be a wartime president, but the invasion of Afghanistan was not just a political necessity, but the right thing to do.</p>\n\Climate action, education reform, protection and expansion of our welfare programs, all have been more successful than not. Still, many people see Gore as a 'crisis president;'. They have no idea what's coming.</div>",
            "image_url": "https://images2.imgbox.com/8b/e5/M8TGYFfJ_o.png",
            "winning_electoral_vote_number": 270,
            "advisor_url": "https://images2.imgbox.com/ef/8b/nySseolu_o.png",
            "recommended_reading":"<ul><li><a href=https://en.wikipedia.org/wiki/Al_Gore style=font-size: 48px; font-weight: 900; text-decoration: none;>Our Supreme Leader</a></li></ul>",
            "has_visits": 1,
            "no_electoral_majority_image": "../static/images/2012-no-majority.jpg"
        }
    }
]

campaignTrail_temp.temp_election_list = [
    {
        "id": 20,
        "year": 2004,
        "is_premium": 0,
        "display_year": "Life In The Balance"
    }
]

const fontLink = document.createElement('link');
fontLink.href = 'https://fonts.googleapis.com/css2?family=Rubik+Bubbles&display=swap';
fontLink.rel = 'stylesheet';
document.head.appendChild(fontLink);

const style = document.createElement('style');
style.textContent = `
  #election_description_window {
    font-family: 'Rubik Bubbles', sans-serif;
  }
`;
document.head.appendChild(style);

campaignTrail_temp.global_parameter_json = [
    {
        "model": "campaign_trail.global_parameter",
        "pk": 1,
        "fields": {
            "vote_variable": 1.125,
            "max_swing": 0.12,
            "start_point": 0.94,
            "candidate_issue_weight": 10,
            "running_mate_issue_weight": 3,
            "issue_stance_1_max": -0.71,
            "issue_stance_2_max": -0.3,
            "issue_stance_3_max": -0.125,
            "issue_stance_4_max": 0.125,
            "issue_stance_5_max": 0.3,
            "issue_stance_6_max": 0.71,
            "global_variance": 0.01,
            "state_variance": 0.005,
            "question_count": 25,
            "default_map_color_hex": "#C9C9C9",
            "no_state_map_color_hex": "#999999"
        }
    }
]

campaignTrail_temp.candidate_json = [
    {
        "model": "campaign_trail.candidate",
        "pk": 1001,
        "fields": {
            "first_name": "Al",
            "last_name": "Gore",
            "election": 20,
            "party": "Democratic",
            "state": "Good",
            "priority": 1,
            "description": "<div style='overflow: auto; height: 200px; margin-top: 0.5em'><p> <b>President Gore is a cautious man. Rather than falling into hysteria and making rash decisions, he waits for the facts and leans on the experts. When terrorists struck at the heart of America on 9/11, he had to lead the charge into Afghanistan, but held firm on militarily pursuing rumors of WMDs in Iraq. Moreover, it reportedly took him over a week of convincing and persuasion by Hillary and the rest of the cabinet to push a healthcare and infrastructure bill through congress. Not to mention the times he fumbled up major democratic-leaning bills that could’ve turned the course of his presidency for good, making him look slow and inefficient towards an already hostile congress.</p>\n\But now, everything has shaken up. A giant threat looming over America, threatening the very existence of our loved heartland has started to form. It is unexplainable, unavoidable and all-consuming. To Gore’s dismay, he’ll need to act quicker than he likes if he wants to contain this new threat and keep up his own reputation. The fate of the nation, and the world, depends on his actions as the ultimate wartime president.</p> </div>",
            "color_hex": "#27cffe",
            "secondary_color_hex": null,
            "is_active": 1,
            "image_url": "https://images2.imgbox.com/2b/19/MoJ5bias_o.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 1002,
        "fields": {
            "first_name": "Joe",
            "last_name": "Lieberman",
            "election": 20,
            "party": "Democratic",
            "state": "Energetic",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#cb2a2a",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://images2.imgbox.com/49/ca/npguoT3S_o.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "<div style='overflow: auto; height: 200px; margin-top: 0.5em'><p> <b>Vice President Lieberman is the aggressor to his boss’s pacifism. He unsuccessfully pushed for the overthrow of Iraqi dictator Saddam Hussein and to learn the truth behind his reported weapons of mass destruction. Lieberman nowadays seems active as well, campaigning alone throughout America for some unknown reason, slowly growing his charisma and separating himself from Gore. Even speaking in some Republican orchestrated events with notable senators and congressmen about issues like 9/11 and the economy. But he has always been against partisanship, the monster halting any sort of advancement in the current presidency, always advocating for progress above all and whipping congress into shape.</p>\n\But what happens when a different monster strikes within America’s borders?</p>\n\Can he convince President Gore to take decisive action to neutralize the greatest threat of our time? Can he keep the country’s spirit high during an unimaginable crisis? Or will the greatest country in the world tear itself apart at the seams…</p> </div>",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 1003,
        "fields": {
            "first_name": "",
            "last_name": "GOP",
            "election": 20,
            "party": "Republican",
            "state": "Hopeful",
            "priority": 1,
            "description": "",
            "color_hex": "#fe3027",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 1004,
        "fields": {
            "first_name": "",
            "last_name": "Undecided",
            "election": 20,
            "party": "Independent",
            "state": "Watching",
            "priority": 1,
            "description": "",
            "color_hex": "#fecf27",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 1005,
        "fields": {
            "first_name": "",
            "last_name": "Reform",
            "election": 20,
            "party": "Reform",
            "state": "Dissatisfied",
            "priority": 1,
            "description": "",
            "color_hex": "#cf30cf",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    // Infection Map Candidates
    {
        "model": "campaign_trail.candidate",
        "pk": 2001,
        "fields": {
            "first_name": "",
            "last_name": "Uninfected",
            "election": 20,
            "party": "Alive",
            "state": "Afraid",
            "priority": 1,
            "description": "",
            "color_hex": "#0068ff",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 2002,
        "fields": {
            "first_name": "",
            "last_name": "Infected",
            "election": 20,
            "party": "Undead",
            "state": "Brains",
            "priority": 1,
            "description": "",
            "color_hex": "#660000",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
]

window.credits = function() {
    credits = ["Lead Dev: MadCowBro", "Coders: HouseyHouse", "Writers: MadCowBro", "Designers: richardbjameson", "Brainstormers: Haj8n, Sammyy, maskedmalarky, Me: the Fellow"]
    text = ""
    for (i in credits) {
      text += credits[i] + "\n"
    }
    alert(text)
}
campaignTrail_temp.credits = "<button onclick='credits()'>The Zomb Squad</button>";


campaignTrail_temp.running_mate_json = [
    {
        "model": "campaign_trail.running_mate",
        "pk": 109261,
        "fields": {
            "candidate": 1001,
            "running_mate": 1002
        }
    }
]

campaignTrail_temp.opponents_default_json = [
    {
        "election": 20,
        "candidates": [
            1001,
            1003,
            1004,
            1005
        ]
    }
]

campaignTrail_temp.opponents_weighted_json = [
    {
        "election": 20,
        "candidates": [
            1001,
            1003,
            1004,
            1005
        ]
    }
]

jet_data = {
    "headerColor": "#d52080",
    "windowColor": "#30e12d",
    "containerColor": "#000000",
    "innerWindowColor": "#2448db",
    "bannerImageUrl": "https://images2.imgbox.com/63/3b/r8qqqShR_o.png",
    "backgroundImageUrl": "https://images2.imgbox.com/ea/e7/PkG59Zmr_o.png",
    "endingTextColor": "#000000",
    "customQuote": "",
    "gameTitle": "LIFE IN THE BALANCE"
}

//#startcode

nct_stuff.themes[nct_stuff.selectedTheme].coloring_title = "#d52080";

nct_stuff.themes[nct_stuff.selectedTheme].coloring_window = "#30e12d";

document.getElementsByClassName("game_header")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_title;

$("#game_window")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_window;

$(".container")[0].style.backgroundColor = "#000000";

document.getElementById("header").src = "https://images2.imgbox.com/63/3b/r8qqqShR_o.png";

document.body.background = "https://images2.imgbox.com/ea/e7/PkG59Zmr_o.png";

document.head.innerHTML += "<style>#results_container {color:#000000;} .inner_window_w_desc {background-color:#0f0f0fff!important; color: white;}</style>";

campaignTrail_temp.modBoxTheme = {
  "header_color": "#000000ff",
  "header_image_url": "https://images2.imgbox.com/94/6b/br5hZtyj_o.png",
  "header_text_color": "#ffffffff",
  "description_text_color": "#ffffffff",
  "description_background_color": "#e1297fff",
  "main_color": "#04021aff",
  "secondary_color": "#22de22ff",
  "ui_text_color": "#ffffffff"
}


const _gameWindow = document.getElementById("game_window"); 
if (_gameWindow) {
    _gameWindow.style.border = "5px solid #ffffffff"; 
}

corrr=`<img src='https://images2.imgbox.com/bb/f5/KHJqG08w_o.png' width='100%'/><span id="after_button"></span>`;
if (gameWindow) {
    // Set the dark border for the game window
    gameWindow.style.border = "8px double #39de54ff";
    gameWindow.style.boxShadow = "0 0 17px rgba(57, 222, 84, 0.8)";
}

    document.head.innerHTML += `<link
      rel="stylesheet"
      href="https://jetsimon.com/public/crt.css"
    >`
    
    document.body.classList.add("crt");

$("#game_window")[0].style.backgroundImage = "url(https://images2.imgbox.com/42/13/ujTe4POz_o.png)"

e = campaignTrail_temp

e.HomeStateText = "Status:";

function appendStyle() {

    if (!document.querySelector('meta[name="viewport"]')) {
        const metaTag = document.createElement('meta');
        metaTag.name = "viewport";
        metaTag.content = "width=device-width, initial-scale=1";
        document.head.appendChild(metaTag);
    }

if (!document.querySelector('#radio-option-style')) {
        const style = document.createElement('style');
        style.id = 'radio-option-style';
        style.textContent = `
			#election_description_window {
				background-color: rgba(42, 42, 42, 1);
				color: white;
				height: 220px;
				border-color: #123ce8ff;
				border-width: 2px;
				border-style: solid;
				border-image: initial;
                box-shadow: 0 0 17px rgba(18, 60, 232, 0.65);
                font-size: 18px;
                font-family: Rubik Bubbles;
			}
			#election_image {
              width: 300px;
              height: 160px;
			  background-image: url('https://images2.imgbox.com/02/ee/t6kwrDON_o.png');
              border: 4px double rgba(224, 224, 224, 1);
              box-shadow: 0 0 5px rgba(255, 255, 255, 0.75);
			}
			#election_image img {
			  padding: 1px;
			  z-index: 0;
			  opacity: 0;
			}
			#inner_window_1 {
			  margin: 1em;
			}

#visit_window {
  height: auto;
}

.inner_window_question h3 {
	margin: 0 1em .5em;
	border: solid;
    border-color: #39de54;
    background-color: #49258f;
}

.inner_window_w_desc {
	background-color: #ffd3d3;
	/* margin: 1em 1em 0;
	padding-top: .5em; */
	border: 5px solid #39de54ff;
	text-align: center;
	height: 72%;
	position: relative;
	clear: both
}

.inner_window_question {
    background-color: #000000;
    border-style: solid;
    border-color: #ffffff;
    text-align: center;
    height: 45%;
    position: relative;
    clear: both;
}

#game_window {
	background-color: #BFE6FF;
	margin: .5em;
	border-style: solid;
	border-color: #C9C9C9;
	border-width: 3px;
	height: 53em;
	text-align: center;
	position: relative
}

.inner_inner_window {
	background: #000000;
	color: white;
	margin: 0;
	height: 85%
}

#running_mate_pic {
    height: 28%;
    border: double;
    border-color: #2254de;
    box-shadow: 0 0 5px rgba(34, 84, 222, 0.8);
    float: right;
    margin-right: 13em;
    overflow: hidden;
    display: block;
    line-height: 0;
}

#candidate_pic {
    height: 28%;
    border: double;
    border-color: #2254de;
    float: left;
    margin-left: 13em;
}

.overlay_window {
  font-family: "Press Start 2P", monospace;
  text-transform: uppercase;
  background: repeating-linear-gradient(
      90deg,
      #0c0c0c,
      #0c0c0c 6px,
      #121212 6px,
      #121212 12px
  );
  border: 4px solid transparent;
  border-radius: 0;
  padding: 1.5rem;
  width: fit-content;
  max-width: 90%;
  left: 28%;
  background-image:
    linear-gradient(#0c0c0c, #0c0c0c),
    linear-gradient(120deg, red, orange, yellow, lime, cyan, blue, violet, red);
  background-origin: border-box;
  background-clip: padding-box, border-box;
  color: #ffffff;
  box-shadow:
    0 0 20px rgba(255, 255, 255, 0.2),
    0 0 35px rgba(255, 255, 255, 0.15);
}

.overlay_window h3 {
  padding: 1rem;
  margin: 0 0 1rem 0;
  background: black;
  border-bottom: 4px solid #ffffff;
  color: white;
  text-shadow:
    0 0 6px red,
    0 0 12px yellow,
    0 0 18px cyan;
  letter-spacing: 2px;
}

.overlay_window p {
  font-size: 8px;
  line-height: 4em;
  margin: 0.8em 0;
  color: #f2f2f2;
  text-shadow:
    0 0 4px red,
    0 0 6px yellow,
    0 0 8px cyan;
}

.overlay_window img {
  margin-top: 1rem;
  border: 4px solid #FFF;
  image-rendering: pixelated;
  box-shadow:
    0 0 10px red,
    0 0 18px cyan,
    0 0 26px magenta;
  animation: rainbowShift 7s linear infinite;
}

.visit_text {
  margin-inline: auto;
  margin-top: 1rem;
  background: black;
  padding: 0.6rem 1.2rem;
  border: 3px solid transparent;
  background-image:
    linear-gradient(black, black),
    linear-gradient(90deg, red, orange, yellow, lime, cyan, blue, violet, red);
  background-origin: border-box;
  background-clip: padding-box, border-box;
  color: white;
  text-shadow:
    0 0 5px cyan,
    0 0 12px magenta;
}

@keyframes rainbowShift {
  0% { filter: hue-rotate(0deg); }
  100% { filter: hue-rotate(360deg); }
}

@keyframes rainbowText {
  0% { color: #ff7070; }
  25% { color: #ffe066; }
  50% { color: #87ff9e; }
  75% { color: #7ad7ff; }
  100% { color: #ff70f0; }
}

@keyframes rainbowPulse {
  0% { box-shadow: 0 0 10px red; }
  20% { box-shadow: 0 0 10px orange; }
  40% { box-shadow: 0 0 10px yellow; }
  60% { box-shadow: 0 0 10px lime; }
  80% { box-shadow: 0 0 10px cyan; }
  100% { box-shadow: 0 0 10px magenta; }
}

@keyframes crtPop {
  0% { transform: scale(0.75); opacity: 0; filter: brightness(0.4); }
  60% { transform: scale(1.1); opacity: 1; }
  100% { transform: scale(1); }
}

@keyframes scanlines {
  0% { filter: contrast(1) brightness(1); }
  50% { filter: contrast(1.1) brightness(1.1); }
  100% { filter: contrast(1) brightness(1); }
}

.visit_text {
  background: #222222;
  color: #ffffff;
  border-radius: .4em;
    width: fit-content;
  margin-inline: auto;
  padding: .5rem 1rem;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
}

.overlay_window img {
	margin-top: .7em;
    border: solid;
	border-color: #787878;
}

.description_window_small {
	background-color: #202020;
	height: 47%;
	margin: 2em 1em;
	padding: .2em;
	border-style: double;
	border-color: #C9C9C9
}

.inner_window_sign_display {
	margin: 0;
	height: 25%;
	position: relative;
	width: 30%;
	height: 28%;
	background-color: #000000;
	color: white;
	margin-left: auto;
	margin-right: auto;
	border-style: solid;
	border-color: #e52b2b;
}

#main_content_area {
	margin: 0;
	height: 72%;
}

.campaign_trail_start_emphasis {
  background: none;
}

.election_collage {
	background: none;
	margin: 1em 2em;
	padding: 0;
	border-style: solid;
	border-color: #fff2f2ff
}

.person_summary ul {
                display: flex;
                flex-flow: column;
                padding: 0;
                margin: 0;
            }

            .person_summary li {
                margin: .75em 0 0 0;
                border: 1px solid rgba(233, 14, 127, 1);
                font-family: Tahoma;
            }

.person_summary ul {
                list-style: none;
}

.person_summary li::before {
                content: "--> ";
                font-weight: bold;
            }

.game_header {
        padding: 0px;
        border-color: #FFF;
        background-color: transparent;
}

      #candidate_description_window {
        background-color: #3a3a3aff;
    border-color: #123ce8ff;
    border-width: 2px;
    border-style: double;
    border-image: initial;
    color: white;
      }

      #running_mate_description_window {
        background-color: #3a3a3aff;
    border-color: #123ce8ff;
    border-width: 2px;
    border-style: double;
    border-image: initial;
    color: white;
      }

#candidate_image, #running_mate_image {
  border: 7px solid #080808ff;
    box-shadow:
    0 0 12px rgba(215, 224, 48, 0.8),
    0 0 25px rgba(210, 144, 20, 0.8),
    0 0 8px rgba(222, 194, 36, 0.8);
}

button:not(.player-control-button), .btn, .is-info, .is-success, .is-primary, .is-secondary {
  box-sizing: border-box;
  padding: 4px 12px;
  font-size: 10px;
  font-family:"Press Start 2P", monospace;
    cursor: pointer;

  background: #00b0ff;
  color: #ffffff;

  border: 3px solid #000000;
  border-radius: 0;
    box-shadow:
    0 0 0 3px #ffffff inset,
    4px 4px 0 #000000;
    transition: transform 0.15s ease;
}

button:not(.player-control-button):hover,
.btn:hover,
.is-info:hover,
.is-success:hover,
.is-primary:hover,
.is-secondary:hover {
  transform: translate(-3px, -3px);
    box-shadow:
    0 0 0 3px #ffffff inset,
    6px 6px 0 #000000;
}

        `;
        document.head.appendChild(style);
}

// Psst: this is for replacing the site_description with this custom modal.
(() => {
    const CONFIG = {
        imageSrc: 'https://images2.imgbox.com/e4/60/RVw5TT2i_o.png',
        margin: '-20px',
        widthCalc: 'calc(100% - 30px)',
    };

    (function addPrologueBorder() {
        const id = 'prologue-border-style';
        if (document.getElementById(id)) return;
        const s = document.createElement('style');
        s.id = id;
        s.textContent = `
            #inner_window_1 {
                box-sizing: border-box;
                border: 3px solid #e74b89ff;
                padding: 8px;
                background: #1e1e1eff;
            }
        `;
        document.head.appendChild(s);
    })();

    const inner = document.getElementById('inner_window_1');
    if (!inner || inner.children.length < 3) return;
    const [headingEl, contentEl] = inner.children;
    const gameStart = document.getElementById('game_start');
    const gameWindow = document.getElementById('game_window');

    if (gameWindow) gameWindow.style.height = 'auto';

    headingEl.innerHTML = `<h3 style="font-size: 60px; font-family: Impact; color: #ffffffff; letter-spacing: 15px"><i>Status Update</i></h3>`;
    Object.assign(contentEl.style, { marginLeft: CONFIG.margin, width: CONFIG.widthCalc });
    contentEl.innerHTML = generatePrologueHTML(CONFIG);

    Object.assign(contentEl.style, { 
        marginLeft: CONFIG.margin, 
        width: CONFIG.widthCalc, 
        color: 'white'
    });

    if (gameStart) {
        gameStart.innerHTML = '<strong>Let’s Fricking Go</strong>';
        const clearHeight = () => { if (gameWindow) gameWindow.style.removeProperty('height'); };
        if (window.jQuery) $('#game_start').on('click', clearHeight);
        else gameStart.addEventListener('click', clearHeight);
    }

    function generatePrologueHTML({ imageSrc }) {
        // Fixed: Corrected HTML string concatenation and escaped single quote in text
        return `
        <div style="display: flex; justify-content: center; align-items: center; margin-bottom: 15px;">
            <div class="gradient-fade-right">
                <img src="${imageSrc}" alt="alt text" />
            </div>
        </div>
        <p>
            <div style='text-decoration: color: #000000ff; font-family: Arial; font-weight: 500; font-size: 15px; letter-spacing: 2px;'>
"'Mr President, help! Send help, please, before its too-AAARGGH!!!'</p>\n\
<p>This is not a normal incumbency sim. You will need to fight for your survival and that of the nation, literally. The vast resources of the federal government are at your disposal, but mismanagement or overmanagement at any level can have catastrophic consequences. The American people look to you, President Gore, to save them from certain doom.</p>
            </div>
        </p>
        `;
    }

})();

}

appendStyle();

function ensureStylesheet(url, id) {
	if (id && document.getElementById(id)) {
        if (id === 'unpkg-7css') {
            const link = document.getElementById(id);
if (link) link.remove();
            return; 
      
    }
        return;
    }
	if (document.querySelector('link[rel="stylesheet"][href="' + url + '"]')) return;
const link = document.createElement('link');
	link.rel = 'stylesheet';
	link.href = url;
	if (id) link.id = id;
	document.head.appendChild(link);
}



function ensureMetaViewport() {
    if (!document.querySelector('meta[name="viewport"]')) {
        const m = document.createElement('meta');
        m.name = 'viewport';
        m.content = 'width=device-width, initial-scale=1';
        document.head.appendChild(m);
    }
}

applyGlobalStyles.sheets = {};

function applyGlobalStyles(css, id = 'app-theme') {
    if ('adoptedStyleSheets' in document && 'replaceSync' 
in CSSStyleSheet.prototype) {
        if (!applyGlobalStyles.sheets[id]) {
            applyGlobalStyles.sheets[id] = new CSSStyleSheet();
document.adoptedStyleSheets = [...document.adoptedStyleSheets, applyGlobalStyles.sheets[id]];
        }
        applyGlobalStyles.sheets[id].replaceSync(css);
        return;
    }

    let el = document.getElementById(id);
    if (!el) {
        el = document.createElement('style');
el.id = id;
        document.head.appendChild(el);
    }
    el.textContent = css;
}

class Song {
  constructor(title, artist, coverLink, audioLink) {
    this.title = title;
    this.artist = artist;
this.coverLink = coverLink;
    this.audioLink = audioLink;
  }
  getTitle() { return this.title; }
  getArtist() { return this.artist;
}
  getCoverLink() { return this.coverLink; }
  getAudioLink() { return this.audioLink;
}
}

class Playlist {
  constructor() {
    this.songs = [];
    this.currentSongIndex = 0;
  }
  addSong(song) { this.songs.push(song);
}
  getCurrentSong() { return this.songs[this.currentSongIndex]; }
  playNext() { this.currentSongIndex = (this.currentSongIndex + 1) % this.songs.length;
}
  playPrevious() { this.currentSongIndex = (this.currentSongIndex - 1 + this.songs.length) % this.songs.length; }
}

window.Playlist = Playlist;
window.Song = Song;
function changePlaylist(newPlaylist) {
  playlist = newPlaylist;
  playlist.currentSongIndex = 0;
  updateUI(playlist);
  const audio = document.getElementById("audio");
  audio.src = playlist.getCurrentSong().audioLink;
  audio.play();
}
window.changePlaylist = changePlaylist;

function updateUI(playlist) {
  const currentSong = playlist.getCurrentSong();
  const player = document.getElementById("player");
  if (!player) return;
  player.querySelector("#cover").src = currentSong.getCoverLink();
  player.querySelector("#title").textContent = currentSong.getTitle();
  player.querySelector("#artist").textContent = currentSong.getArtist();

  const listItems = player.querySelectorAll(".playlist-item");
  listItems.forEach((li, idx) => {
    li.classList.toggle("active", idx === playlist.currentSongIndex);
  });
}

function setupMusicPlayer() {
  playlist = new Playlist();

  const songs = [
    new Song("Ghost Town", "The Specials", "https://images2.imgbox.com/c5/b3/DR6ckUJf_o.png", "https://audio.jukehost.co.uk/SJeiun2nJbkn8tBMq9CIkdMBYYrDP6XU"),
    new Song("She Wants To Move", "N.E.R.D", "https://images2.imgbox.com/13/46/CqfzCFhC_o.png", "https://audio.jukehost.co.uk/qDbHxlgmng4fqgEVEK4jjjgJPViujpPH"),
    new Song("We Don't Care", "Kanye West", "https://images2.imgbox.com/27/2c/q2N5KNKE_o.png", "https://audio.jukehost.co.uk/gIbK6gS4tRCtMoGV2fmnk4PnqW59xqOS"),
    new Song("Extraordinary Girl", "Green Day", "https://images2.imgbox.com/92/5c/QjhJYYUX_o.png", "https://audio.jukehost.co.uk/wMJlyYwhjL5dkSslPWiOYrxprZVe9BFa"),
    new Song("Spiderhead", "Cage The Elephant", "https://images2.imgbox.com/58/15/sn6QeSxc_o.png", "https://audio.jukehost.co.uk/1AIuUdJRMZJOxd8WklXDgovDfEDoKW5O"),
    new Song("Tiny Cities Made Of Ashes", "Modest Mouse", "https://images2.imgbox.com/05/93/r8nqpDMD_o.png", "https://audio.jukehost.co.uk/7k2vp4D8ZpxQHHWtw4H72sqiRoVxEv28"),
    new Song("No Phone", "CAKE", "https://images2.imgbox.com/0f/1f/7BUd2lXJ_o.png", "https://audio.jukehost.co.uk/COQHhSHOYAY3d7RvxajPlqiHefUW4TKJ"),
  ];
  songs.forEach(s => playlist.addSong(s));

  const existing = document.getElementById("player");
  if (existing) existing.remove();

  const playerContainer = document.createElement("div");
  playerContainer.id = "player";
  const leftCol = document.createElement("div");
  leftCol.id = "player-left";
  const cover = document.createElement("img");
  cover.id = "cover";
  cover.alt = "cover";
  leftCol.appendChild(cover);
  playerContainer.appendChild(leftCol);
  const centerCol = document.createElement("div");
  centerCol.id = "player-center";

  const titleEl = document.createElement("div");
  titleEl.id = "title";
  centerCol.appendChild(titleEl);

  const artistEl = document.createElement("div");
  artistEl.id = "artist";
  centerCol.appendChild(artistEl);

  const controlsRow = document.createElement("div");
  controlsRow.id = "controls-row";
  controlsRow.className = "controls-only";

  const prevBtn = document.createElement("button");
  prevBtn.id = "prevButton";
  prevBtn.className = "control-btn";
  prevBtn.textContent = "⏮"; 
  prevBtn.title = "Previous Song";
  controlsRow.appendChild(prevBtn);

  const playPauseBtn = document.createElement("button");
  playPauseBtn.id = "playPauseButton";
  playPauseBtn.className = "control-btn";
  playPauseBtn.textContent = "►";
  playPauseBtn.title = "Play";
  controlsRow.appendChild(playPauseBtn);

  const nextBtn = document.createElement("button");
  nextBtn.id = "nextButton";
  nextBtn.className = "control-btn";
  nextBtn.textContent = "⏭"; 
  nextBtn.title = "Next Song";
  controlsRow.appendChild(nextBtn);

  centerCol.appendChild(controlsRow);

  const progressRow = document.createElement("div");
  progressRow.id = "progress-row";
  const progressInput = document.createElement("input");
  progressInput.type = "range";
  progressInput.id = "progress-bar";
  progressInput.min = 0;
  progressInput.max = 100;
  progressInput.value = 0;
  progressRow.appendChild(progressInput);
  centerCol.appendChild(progressRow);

  const volRow = document.createElement("div");
  volRow.id = "volume-row";
  const volSlider = document.createElement("input");
  volSlider.type = "range";
  volSlider.id = "volumeSlider";
  volSlider.min = 0;
  volSlider.max = 9;
  volSlider.step = 1;
  volSlider.value = 1;
  volRow.appendChild(volSlider);
  centerCol.appendChild(volRow);

  playerContainer.appendChild(centerCol);

  const rightCol = document.createElement("div");
  rightCol.id = "player-right";
  const playlistList = document.createElement("div");
  playlistList.id = "playlist-list";
  playlist.songs.forEach((song, i) => {
    const item = document.createElement("div");
    item.className = "playlist-item";
    item.textContent = `${song.getTitle()} — ${song.getArtist()}`;
    item.addEventListener("click", () => {
      playlist.currentSongIndex = i;
      audio.src = playlist.getCurrentSong().audioLink;
      audio.play();
      updateUI(playlist);
    });
    playlistList.appendChild(item);
  });
  rightCol.appendChild(playlistList);
  playerContainer.appendChild(rightCol);

  const gameWindow_player = document.getElementById("game_window");
  if (gameWindow_player) gameWindow_player.insertAdjacentElement("afterend", playerContainer);
  else document.body.appendChild(playerContainer);

  const audio = document.createElement("audio");
  audio.id = "audio";
  audio.src = playlist.getCurrentSong().audioLink;
  audio.volume = 1 / 9;
  document.body.appendChild(audio);

  playPauseBtn.addEventListener("click", function () {
    if (audio.paused) audio.play(); else audio.pause();
  });
  audio.addEventListener("play", () => {
    playPauseBtn.textContent = "❚❚";
    playPauseBtn.title = "Pause";
  });
  audio.addEventListener("pause", () => {
    playPauseBtn.textContent = "►";
    playPauseBtn.title = "Play";
  });
  nextBtn.addEventListener("click", function () {
    playlist.playNext();
    audio.src = playlist.getCurrentSong().audioLink;
    audio.play();
    updateUI(playlist);
  });
  prevBtn.addEventListener("click", function () {
    playlist.playPrevious();
    audio.src = playlist.getCurrentSong().audioLink;
    audio.play();
    updateUI(playlist);
  });
  const progressEl = document.getElementById("progress-bar");

  function smoothProgressUpdate() {
    if (audio.duration) {
      const value = (audio.currentTime / audio.duration) * 100;
      progressEl.value = value;
      const fill = `linear-gradient(to right, #51a8e2ff 0%, #51a8e2ff ${value}%, rgba(0,0,0,0.1) ${value}%, rgba(0,0,0,0.1) 100%)`;
      progressEl.style.background = fill;
    }
    requestAnimationFrame(smoothProgressUpdate);
  }
  requestAnimationFrame(smoothProgressUpdate);

  progressEl.addEventListener("input", () => {
    if (audio.duration) audio.currentTime = (progressEl.value / 100) * audio.duration;
  });
  const volumeSlider = document.getElementById("volumeSlider");
  volumeSlider.addEventListener("input", function () {
    audio.volume = parseInt(volumeSlider.value, 10) / 9;
  });
  audio.addEventListener("ended", function () {
    playlist.playNext();
    audio.src = playlist.getCurrentSong().audioLink;
    audio.play();
    updateUI(playlist);
  });
  updateUI(playlist);
}

const style_player = document.createElement("style");
style_player.textContent = `
#player {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  width: 280px;
  margin: 40px auto;
  padding: 18px 12px 30px;
  background: linear-gradient(180deg, #121212ff 0%, #000000ff 100%);
  border: 6px solid #4410deff;
  border-radius: 20px 20px 40px 40px;
  box-shadow: inset 0 3px 8px #0005, 0 8px 18px #0008;
  font-family: "Press Start 2P", monospace;
  color: #121212;
  position: relative;
  overflow: hidden;
}

#player-left {
  width: 220px;
  height: 180px;
  background: radial-gradient(circle at center, #0e0e0eff 0%, #000000ff 80%);
  border: 5px inset #de2121ff;
  border-radius: 6px;
  box-shadow: inset 0 0 15px #0006, 0 2px 5px #000a;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 25px;
  margin-bottom: 10px;
  overflow: hidden;
}
#player-left img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 3px;
  opacity: 0.8;
  filter: contrast(1.3) saturate(1.2);
}

#player-center {
  text-align: center;
  width: 90%;
  background: linear-gradient(180deg, #0e0e0eff 0%, #000000ff 100%);
  border: 3px inset #de2121ff;
  padding: 10px;
  border-radius: 4px;
  box-shadow: inset 0 3px 5px #0004;
}
#title {
  font-size: 10px;
  margin-bottom: 5px;
  color: #e2bc17ff;
}
#artist {
  font-size: 8px;
  color: #e2bc17ff;
}

.controls-only .control-btn {
  all: unset;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: radial-gradient(circle at center, #111 0%, #000 95%);
  color: #00ffcc;
  font-size: 18px;
  font-weight: 800;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  border: 2px solid #00ffcc;
  box-shadow: 0 0 8px #00ffcc;
  transition: all 0.15s ease-in-out;
}
.controls-only .control-btn:hover {
  background: #00ffcc;
  color: #000;
  box-shadow: 0 0 15px #00ffcc;
  transform: scale(1.05);
}

#controls-row {
  display: flex;
  justify-content: space-around;
  width: 100%;
  margin: 16px 0 12px;
}

#progress-row {
  width: 88%;
  background: #66e83bff;
  border: 3px inset #de2121ff;
  padding: 6px;
  border-radius: 4px;
  margin-bottom: 10px;
}
#progress-bar {
  width: 100%;
  -webkit-appearance: none;
  height: 6px;
  background: #607b4c;
  border-radius: 3px;
  outline: none;
}
#progress-bar::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 10px;
  height: 10px;
  background: #111;
  border-radius: 50%;
  cursor: pointer;
}

#volume-row {
  width: 70%;
  display: flex;
  justify-content: center;
  background: #66e83bff;
  border: 2px inset #5e13e1ff;
  border-radius: 4px;
  padding: 4px;
  margin-bottom: 12px;
}
#volumeSlider {
  width: 80px;
  -webkit-appearance: none;
  height: 6px;
  background: #5fa724ff;
  border-radius: 3px;
}
#volumeSlider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #111;
}

#player-right {
  width: 90%;
  background: #000000ff;
  border: 3px inset #de2121ff;
  border-radius: 6px;
  padding: 6px;
  max-height: 110px;
  overflow-y: auto;
  box-shadow: inset 0 1px 4px #0007;
}
.playlist-item {
  font-size: 7px;
  line-height: 1.5;
  cursor: pointer;
  color: #66e83bff;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}
.playlist-item.active {
  color: #e21d1d;
  font-weight: bold;
}
`;
document.head.appendChild(style_player);

setupMusicPlayer();

function addDynamicCSS() {
    var css = `
	#overall_result_container {
		height: auto;
        min-height: 6em;
	}
	#state_result_container {
		height: auto;
        min-height: 6em;
	}
	.inner_window_question {
        height: auto;
	}	
	.inner_window_question .inner_inner_window {
        height: auto;
	}		
	.inner_window_question .inner_inner_window .question_form {
        height: auto;
	}
	.overlay_window {
        height: auto;
	}
	.recommended_reading_box {
        height: auto;
    }
		
    .mytooltip {
        position: relative;
        display: inline-block;
        cursor: help;
        color: #ff008c;
        font-weight: 800;
        text-decoration: underline dotted #ffca1b;
        font-family: "Press Start 2P", monospace;
        letter-spacing: 0.5px;
        text-shadow:
            0px 0px 1px #ff008c,
            0px 0px 3px #ff5fb5;
    }

    .mytooltip .mytooltiptext {
        width: auto;
        max-width: 360px;
        min-width: 120px;
        white-space: normal;

        background: repeating-linear-gradient(
            45deg,
            #ffca1b,
            #ffca1b 8px,
            #ffe37d 8px,
            #ffe37d 16px
        );
        color: #000000;

        border: 4px solid #ff008c;
        outline: 3px solid #000000;
        border-radius: 4px;

        padding: 16px 20px;
        position: absolute;
        z-index: 200;
        opacity: 0;

        pointer-events: none;
        font-size: 13px;
        line-height: 1.55;
        font-weight: 700;
        font-family: "Press Start 2P", monospace;

        bottom: 130%;
        left: 50%;
        transform-origin: bottom center;
        transform: translateX(-50%) translateY(10px) scale(0.9);

        transition:
            opacity 0.18s ease-out,
            transform 0.18s ease-out;
    }

    .mytooltip .mytooltiptext::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -8px;
        border-width: 8px;
        border-style: solid;
        border-color: #ff008c transparent transparent transparent;
        filter: drop-shadow(0px 0px 2px #000);
    }

    .mytooltip:hover .mytooltiptext {
        opacity: 1;
        transform: translateX(-50%) translateY(0) scale(1);
    }

    .mytooltip .mytooltiptext img {
        max-width: 100%;
        height: auto;
        border-radius: 0;
        margin-top: 12px;
        border: 4px solid #ff008c;
        outline: 3px solid #000000;
    }

    `;

    var styleElem = document.createElement('style');
    styleElem.type = 'text/css';

    styleElem.appendChild(document.createTextNode(css));

    document.head.appendChild(styleElem);
}


addDynamicCSS();

let crtStyle = document.createElement('style');
document.head.appendChild(crtStyle);

let crtOn = true;
var setCRTLines = (enabled) => {
    crtStyle.innerText = enabled ? "" : ".crt::before {background: none;}";
}
footer = $(".footer")[0]
var button = document.createElement("button") // <button onclick="changeBanner()" style="font-weight: bold; height:19.49px; position: static; right: 770px; top: 0px;">Change banner</button>
button.style = `font-weight: bold; height:19.49px; position: static; right: 770px; top: 0px;`
button.innerHTML = "Toggle CRT Lines"
footer.insertBefore(button, footer.firstChild);
button.addEventListener("click", () => {crtOn = !crtOn; setCRTLines(crtOn)});

		
tooltipList = [
  {searchString: "Trump", explanationText: "<img src=https://images2.imgbox.com/e7/5b/xGvHSmAD_o.png> Your old opponent, pretty funny guy."},
  {searchString: "Placeholder 2", explanationText: "<img src=https://i.imgur.com/PUT IMGUR LINK HERE> Put the Text Here"}
];

//#endcode
